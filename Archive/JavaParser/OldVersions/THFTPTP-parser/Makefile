# File:    Makefile 
# Author:  Alexandre Riazanov (alexandre.riazanov@gmail.com)
# Created: Feb 02, 2006
# Purpose: Makefile for TPTP parser in Java
#
#
# Note: the tptp_tester can be run by using
#  java -cp ./TptpParser.jar:/--full-path-to-antlr--/antlr-2.7.5/lib/antlr.jar tptp_parser.tptp_tester <input file>
#
######################################################################


#   Change what you have to change here:

# full-path-to-antlr, like  /.../antlr-2.7.5/lib/antlr.jar
ANTLR_JAR = $(PWD)/antlr-2.7.5.jar

######################################################################

SRC = ./tptp_parser/*.java ./*.java 
CLS = ./tptp_parser/SimpleTptpParserOutput.class \
      ./tptp_parser/TptpParserOutput.class

###  Parser sources that are generated by ANTLR from tptp.g
PARSER_SRC = ./tptp_parser/TptpLexer.java ./tptp_parser/TptpTokenTypes.java ./tptp_parser/TptpParser.java
PARSER_CLS = ./tptp_parser/TptpLexer.class ./tptp_parser/TptpTokenTypes.class ./tptp_parser/TptpParser.class

NESTED_CLS = ./tptp_parser/*\$$*.class


DOCDIR = ./doc
TRASH = $(CLS) $(NESTED_CLS) $(DOCDIR) \
          ./*~ ./*/*~ ./*$$*.class \
          ./tptp_parser/TptpTokenTypes.txt ./tptp_parser/TptpTokenTypes.txt


######################################################################

default: TptpParser.jar

TptpParser.jar: $(CLS) $(PARSER_CLS)
	jar cf TptpParser.jar $(CLS) $(PARSER_CLS) $(NESTED_CLS) 

%.class: %.java ./tptp_parser/tptp.g ./tptp_parser/TptpParser.java
	javac -Xlint -classpath .:./tptp_parser:$(ANTLR_JAR) $<

./tptp_parser/TptpParser.java ./tptp_parser/TptpLexer.java: ./tptp_parser/tptp.g
	cd ./tptp_parser; java -classpath .:$(ANTLR_JAR) antlr.Tool ./tptp.g

doc: $(SRC)
	mkdir -p $(DOCDIR)
	javadoc -d $(DOCDIR) $(SRC)

test: tptp_tester.class
	java -cp .:./TptpParser.jar:$(ANTLR_JAR) tptp_tester test.p

tptp_tester.class: ./tptp_tester.java 
	javac -Xlint -classpath ./TptpParser.jar:$(ANTLR_JAR) $<


clean:
	rm -rf $(TRASH) $(PARSER_SOURCES) $(PARSER_CLS)

distclean: clean
	rm -rf $(PARSER_SRC) TptpParser.jar
######################################################################

